! ROSCO IO
! This file is automatically generated by write_registry.py using ROSCO v2.10.0
! For any modification to the registry, please edit the rosco_types.yaml accordingly
 
MODULE ROSCO_IO
    USE, INTRINSIC :: ISO_C_Binding
    USE ROSCO_Types
    USE ReadSetParameters
    USE Constants
IMPLICIT NONE

CONTAINS

SUBROUTINE WriteRestartFile(LocalVar, CntrPar, ErrVar, objInst, RootName, size_avcOUTNAME)
    TYPE(LocalVariables), INTENT(IN)                :: LocalVar
    TYPE(ControlParameters), INTENT(INOUT)          :: CntrPar
    TYPE(ObjectInstances), INTENT(INOUT)            :: objInst
    TYPE(ErrorVariables), INTENT(INOUT)             :: ErrVar
    INTEGER(IntKi), INTENT(IN)                      :: size_avcOUTNAME
    CHARACTER(size_avcOUTNAME), INTENT(IN)        :: RootName 
    
    INTEGER(IntKi)               :: Un                  ! I/O unit for pack/unpack (checkpoint & restart)
    INTEGER(IntKi)               :: I                   ! Generic index.
    CHARACTER(128)               :: InFile              ! Input checkpoint file
    INTEGER(IntKi)               :: ErrStat
    CHARACTER(128)               :: ErrMsg              
    CHARACTER(128)               :: n_t_global          ! timestep number as a string

    WRITE(n_t_global, '(I0.0)' ) NINT(LocalVar%Time/LocalVar%DT)
    InFile = TRIM(RootName)//TRIM( n_t_global )//'.RO.chkp'
    CALL GetNewUnit(Un, ErrVar)
    OPEN(unit=Un, FILE=TRIM(InFile), STATUS='UNKNOWN', FORM='UNFORMATTED' , ACCESS='STREAM', IOSTAT=ErrStat, ACTION='WRITE' )

    IF ( ErrStat /= 0 ) THEN
        ErrVar%aviFAIL = 1
        ErrVar%ErrMsg  = 'ROSCO_IO: Cannot open checkpoint file '//TRIM(InFile)//' for writing'

    ELSE
        WRITE( Un, IOSTAT=ErrStat) LocalVar%iStatus
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AlreadyInitialized
        WRITE( Un, IOSTAT=ErrStat) LocalVar%RestartWSE
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Time
        WRITE( Un, IOSTAT=ErrStat) LocalVar%DT
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WriteThisStep
        WRITE( Un, IOSTAT=ErrStat) LocalVar%n_DT
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Time_Last
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_GenPwr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenSpeed
        WRITE( Un, IOSTAT=ErrStat) LocalVar%RotSpeed
        WRITE( Un, IOSTAT=ErrStat) LocalVar%NacHeading
        WRITE( Un, IOSTAT=ErrStat) LocalVar%NacVane
        WRITE( Un, IOSTAT=ErrStat) LocalVar%NacVaneF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%HorWindV
        WRITE( Un, IOSTAT=ErrStat) LocalVar%HorWindV_F
        WRITE( Un, IOSTAT=ErrStat) LocalVar%rootMOOP(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%rootMOOP(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%rootMOOP(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%rootMOOPF(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%rootMOOPF(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%rootMOOPF(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%BlPitch(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%BlPitch(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%BlPitch(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%BlPitchCMeas
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Azimuth
        WRITE( Un, IOSTAT=ErrStat) LocalVar%OL_Azimuth
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AzUnwrapped
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AzError
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenTqAz
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AzBuffer(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AzBuffer(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%NumBl
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_Acc
        WRITE( Un, IOSTAT=ErrStat) LocalVar%NacIMU_FA_Acc
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_AccHPF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_AccHPFI
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_PitCom(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_PitCom(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_PitCom(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd_TSR
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd_TRA
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd_RL
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_RefSpd
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_RefSpd_SS
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_RefSpd_PRC
        WRITE( Un, IOSTAT=ErrStat) LocalVar%RotSpeedF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenSpeedF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenTq
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenTqMeas
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenArTq
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenBrTq
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_KOmega2_GenTq
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_ConstPwr_GenTq
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_PitComF(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_PitComF(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_PitComF(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_KP
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_KI
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_KD
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_TF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_MaxPit
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_MinPit
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_Last
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_PitComTF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_IPC(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_IPC(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_IPC(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_PwrErr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_SpdErr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisTilt_1P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisYaw_1P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisTilt_2P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisYaw_2P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%axisTilt_1P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%axisYaw_1P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%axisYawF_1P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%axisTilt_2P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%axisYaw_2P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%axisYawF_2P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_KI(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_KI(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_KP(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_KP(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%IPC_IntSat
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PC_State
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitCom(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitCom(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitCom(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitCom_SD(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitCom_SD(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitCom_SD(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitComAct(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitComAct(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PitComAct(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SS_DelOmegaF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%TestType
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Kp_Float
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_MaxTq
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_LastGenTrq
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_LastGenPwr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_MechGenPwr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_SpdErrAr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_SpdErrBr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_SpdErr
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_State
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_Rgn3Pitch
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE_Vw
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE_Vw_F
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE_VwI
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE_VwIdot
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE_Op
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE_Op_Last
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_LastGenTrqF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PRC_WSE_F
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Speed
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Torque
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Pitch
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Total
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PRC_Min_Pitch
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PS_Min_Pitch
        WRITE( Un, IOSTAT=ErrStat) LocalVar%OL_Index
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SU_Stage
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SU_LoadStageStartTime
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SU_RotSpeedF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SD_Trigger
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SD_BlPitchF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SD_NacVaneF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SD_GenSpeedF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SD_Stage
        WRITE( Un, IOSTAT=ErrStat) LocalVar%SD_StageStartTime
        WRITE( Un, IOSTAT=ErrStat) LocalVar%GenTq_SD
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Fl_PitCom
        WRITE( Un, IOSTAT=ErrStat) LocalVar%NACIMU_FA_AccF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_AccF
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FA_Hist
        WRITE( Un, IOSTAT=ErrStat) LocalVar%TRA_LastRefSpd
        WRITE( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpeed
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTDX
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTDY
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTDZ
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRDX
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRDY
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRDZ
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTVX
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTVY
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTVZ
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRVX
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRVY
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRVZ
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTAX
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTAY
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmTAZ
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRAX
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRAY
        WRITE( Un, IOSTAT=ErrStat) LocalVar%PtfmRAZ
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(4)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(5)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(6)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(7)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(8)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(9)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(10)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(11)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(12)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(4)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(5)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(6)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(7)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(8)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(9)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(10)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(11)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(12)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(4)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(5)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(6)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(7)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(8)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(9)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(10)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(11)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(12)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(4)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(5)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(6)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(7)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(8)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(9)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(10)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(11)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%StC_Input(12)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Flp_Angle(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Flp_Angle(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%Flp_Angle(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%RootMyb_Last(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%RootMyb_Last(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%RootMyb_Last(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ACC_INFILE_SIZE
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ACC_INFILE
        WRITE( Un, IOSTAT=ErrStat) LocalVar%restart
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AWC_complexangle(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AWC_complexangle(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%AWC_complexangle(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%TiltMean
        WRITE( Un, IOSTAT=ErrStat) LocalVar%YawMean
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_ID
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_YawOffset
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_TorqueOffset
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_PitOffset(1)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_PitOffset(2)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_PitOffset(3)
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_R_Speed
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_R_Torque
        WRITE( Un, IOSTAT=ErrStat) LocalVar%ZMQ_R_Pitch
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE%om_r
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE%v_t
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE%v_m
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE%v_h
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE%P
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE%xh
        WRITE( Un, IOSTAT=ErrStat) LocalVar%WE%K
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_a1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_a0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_b1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_b0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_InputSignalLast
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_OutputSignalLast
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_a2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_a1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_a0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_b2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_b1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_b0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_InputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_OutputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_InputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_OutputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_a2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_a1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_a0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_b2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_b1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_b0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_InputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_OutputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_InputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_OutputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%hpf_InputSignalLast
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%hpf_OutputSignalLast
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_OutputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_OutputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_InputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_InputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_b2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_b0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_a2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_a1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_a0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_OutputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_OutputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_InputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_InputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_b2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_b1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_b0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_a1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%FP%nf_a0
        WRITE( Un, IOSTAT=ErrStat) LocalVar%piP%ITerm
        WRITE( Un, IOSTAT=ErrStat) LocalVar%piP%ITermLast
        WRITE( Un, IOSTAT=ErrStat) LocalVar%piP%ITerm2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%piP%ITermLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%piP%ELast
        WRITE( Un, IOSTAT=ErrStat) LocalVar%resP%res_OutputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%resP%res_OutputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%resP%res_InputSignalLast1
        WRITE( Un, IOSTAT=ErrStat) LocalVar%resP%res_InputSignalLast2
        WRITE( Un, IOSTAT=ErrStat) LocalVar%rlP%LastSignal
        WRITE( Un, IOSTAT=ErrStat) objInst%instLPF
        WRITE( Un, IOSTAT=ErrStat) objInst%instSecLPF
        WRITE( Un, IOSTAT=ErrStat) objInst%instSecLPFV
        WRITE( Un, IOSTAT=ErrStat) objInst%instHPF
        WRITE( Un, IOSTAT=ErrStat) objInst%instNotchSlopes
        WRITE( Un, IOSTAT=ErrStat) objInst%instNotch
        WRITE( Un, IOSTAT=ErrStat) objInst%instPI
        WRITE( Un, IOSTAT=ErrStat) objInst%instRes
        WRITE( Un, IOSTAT=ErrStat) objInst%instRL
        Close ( Un )
        IF ( ErrStat /= 0 ) THEN
            ErrVar%aviFAIL = 1
            ErrVar%ErrMsg  = 'ROSCO_IO: Error writing checkpoint file.'
        ENDIF
    ENDIF
END SUBROUTINE WriteRestartFile

 
SUBROUTINE ReadRestartFile(avrSWAP, LocalVar, CntrPar, objInst, PerfData, RootName, size_avcOUTNAME, ErrVar)
    TYPE(LocalVariables), INTENT(INOUT)             :: LocalVar
    TYPE(ControlParameters), INTENT(INOUT)          :: CntrPar
    TYPE(ObjectInstances), INTENT(INOUT)            :: objInst
    TYPE(PerformanceData), INTENT(INOUT)            :: PerfData
    TYPE(ErrorVariables), INTENT(INOUT)             :: ErrVar
    REAL(ReKi), INTENT(IN)                          :: avrSWAP(*)
    INTEGER(IntKi), INTENT(IN)                      :: size_avcOUTNAME
    CHARACTER(size_avcOUTNAME), INTENT(IN)        :: RootName 
    
    INTEGER(IntKi)               :: Un                  ! I/O unit for pack/unpack (checkpoint & restart)
    INTEGER(IntKi)               :: I                   ! Generic index.
    CHARACTER(128)               :: InFile              ! Input checkpoint file
    INTEGER(IntKi)               :: ErrStat
    CHARACTER(128)               :: ErrMsg              
    CHARACTER(128)               :: n_t_global          ! timestep number as a string

    WRITE(n_t_global, '(I0.0)' ) NINT(avrSWAP(2)/avrSWAP(3))
    InFile = TRIM(RootName)//TRIM( n_t_global )//'.RO.chkp'
    CALL GetNewUnit(Un, ErrVar)
    OPEN(unit=Un, FILE=TRIM(InFile), STATUS='UNKNOWN', FORM='UNFORMATTED' , ACCESS='STREAM', IOSTAT=ErrStat, ACTION='READ' )

    IF ( ErrStat /= 0 ) THEN
        ErrVar%aviFAIL = 1
        ErrVar%ErrMsg  = 'ROSCO_IO: Cannot open checkpoint file '//TRIM(InFile)//' for reading'

    ELSE
        READ( Un, IOSTAT=ErrStat) LocalVar%iStatus
        READ( Un, IOSTAT=ErrStat) LocalVar%AlreadyInitialized
        READ( Un, IOSTAT=ErrStat) LocalVar%RestartWSE
        READ( Un, IOSTAT=ErrStat) LocalVar%Time
        READ( Un, IOSTAT=ErrStat) LocalVar%DT
        READ( Un, IOSTAT=ErrStat) LocalVar%WriteThisStep
        READ( Un, IOSTAT=ErrStat) LocalVar%n_DT
        READ( Un, IOSTAT=ErrStat) LocalVar%Time_Last
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_GenPwr
        READ( Un, IOSTAT=ErrStat) LocalVar%GenSpeed
        READ( Un, IOSTAT=ErrStat) LocalVar%RotSpeed
        READ( Un, IOSTAT=ErrStat) LocalVar%NacHeading
        READ( Un, IOSTAT=ErrStat) LocalVar%NacVane
        READ( Un, IOSTAT=ErrStat) LocalVar%NacVaneF
        READ( Un, IOSTAT=ErrStat) LocalVar%HorWindV
        READ( Un, IOSTAT=ErrStat) LocalVar%HorWindV_F
        READ( Un, IOSTAT=ErrStat) LocalVar%rootMOOP(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%rootMOOP(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%rootMOOP(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%rootMOOPF(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%rootMOOPF(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%rootMOOPF(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%BlPitch(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%BlPitch(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%BlPitch(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%BlPitchCMeas
        READ( Un, IOSTAT=ErrStat) LocalVar%Azimuth
        READ( Un, IOSTAT=ErrStat) LocalVar%OL_Azimuth
        READ( Un, IOSTAT=ErrStat) LocalVar%AzUnwrapped
        READ( Un, IOSTAT=ErrStat) LocalVar%AzError
        READ( Un, IOSTAT=ErrStat) LocalVar%GenTqAz
        READ( Un, IOSTAT=ErrStat) LocalVar%AzBuffer(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%AzBuffer(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%NumBl
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_Acc
        READ( Un, IOSTAT=ErrStat) LocalVar%NacIMU_FA_Acc
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_AccHPF
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_AccHPFI
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_PitCom(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_PitCom(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_PitCom(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd_TSR
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd_TRA
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpd_RL
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_RefSpd
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_RefSpd_SS
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_RefSpd_PRC
        READ( Un, IOSTAT=ErrStat) LocalVar%RotSpeedF
        READ( Un, IOSTAT=ErrStat) LocalVar%GenSpeedF
        READ( Un, IOSTAT=ErrStat) LocalVar%GenTq
        READ( Un, IOSTAT=ErrStat) LocalVar%GenTqMeas
        READ( Un, IOSTAT=ErrStat) LocalVar%GenArTq
        READ( Un, IOSTAT=ErrStat) LocalVar%GenBrTq
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_KOmega2_GenTq
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_ConstPwr_GenTq
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_PitComF(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_PitComF(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_PitComF(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_KP
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_KI
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_KD
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_TF
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_MaxPit
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_MinPit
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_Last
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_PitComTF
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_IPC(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_IPC(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_PitComT_IPC(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_PwrErr
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_SpdErr
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisTilt_1P
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisYaw_1P
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisTilt_2P
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_AxisYaw_2P
        READ( Un, IOSTAT=ErrStat) LocalVar%axisTilt_1P
        READ( Un, IOSTAT=ErrStat) LocalVar%axisYaw_1P
        READ( Un, IOSTAT=ErrStat) LocalVar%axisYawF_1P
        READ( Un, IOSTAT=ErrStat) LocalVar%axisTilt_2P
        READ( Un, IOSTAT=ErrStat) LocalVar%axisYaw_2P
        READ( Un, IOSTAT=ErrStat) LocalVar%axisYawF_2P
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_KI(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_KI(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_KP(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_KP(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%IPC_IntSat
        READ( Un, IOSTAT=ErrStat) LocalVar%PC_State
        READ( Un, IOSTAT=ErrStat) LocalVar%PitCom(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitCom(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitCom(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitCom_SD(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitCom_SD(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitCom_SD(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitComAct(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitComAct(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%PitComAct(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%SS_DelOmegaF
        READ( Un, IOSTAT=ErrStat) LocalVar%TestType
        READ( Un, IOSTAT=ErrStat) LocalVar%Kp_Float
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_MaxTq
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_LastGenTrq
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_LastGenPwr
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_MechGenPwr
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_SpdErrAr
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_SpdErrBr
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_SpdErr
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_State
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_Rgn3Pitch
        READ( Un, IOSTAT=ErrStat) LocalVar%WE_Vw
        READ( Un, IOSTAT=ErrStat) LocalVar%WE_Vw_F
        READ( Un, IOSTAT=ErrStat) LocalVar%WE_VwI
        READ( Un, IOSTAT=ErrStat) LocalVar%WE_VwIdot
        READ( Un, IOSTAT=ErrStat) LocalVar%WE_Op
        READ( Un, IOSTAT=ErrStat) LocalVar%WE_Op_Last
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_LastGenTrqF
        READ( Un, IOSTAT=ErrStat) LocalVar%PRC_WSE_F
        READ( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Speed
        READ( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Torque
        READ( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Pitch
        READ( Un, IOSTAT=ErrStat) LocalVar%PRC_R_Total
        READ( Un, IOSTAT=ErrStat) LocalVar%PRC_Min_Pitch
        READ( Un, IOSTAT=ErrStat) LocalVar%PS_Min_Pitch
        READ( Un, IOSTAT=ErrStat) LocalVar%OL_Index
        READ( Un, IOSTAT=ErrStat) LocalVar%SU_Stage
        READ( Un, IOSTAT=ErrStat) LocalVar%SU_LoadStageStartTime
        READ( Un, IOSTAT=ErrStat) LocalVar%SU_RotSpeedF
        READ( Un, IOSTAT=ErrStat) LocalVar%SD_Trigger
        READ( Un, IOSTAT=ErrStat) LocalVar%SD_BlPitchF
        READ( Un, IOSTAT=ErrStat) LocalVar%SD_NacVaneF
        READ( Un, IOSTAT=ErrStat) LocalVar%SD_GenSpeedF
        READ( Un, IOSTAT=ErrStat) LocalVar%SD_Stage
        READ( Un, IOSTAT=ErrStat) LocalVar%SD_StageStartTime
        READ( Un, IOSTAT=ErrStat) LocalVar%GenTq_SD
        READ( Un, IOSTAT=ErrStat) LocalVar%Fl_PitCom
        READ( Un, IOSTAT=ErrStat) LocalVar%NACIMU_FA_AccF
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_AccF
        READ( Un, IOSTAT=ErrStat) LocalVar%FA_Hist
        READ( Un, IOSTAT=ErrStat) LocalVar%TRA_LastRefSpd
        READ( Un, IOSTAT=ErrStat) LocalVar%VS_RefSpeed
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTDX
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTDY
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTDZ
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRDX
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRDY
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRDZ
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTVX
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTVY
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTVZ
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRVX
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRVY
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRVZ
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTAX
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTAY
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmTAZ
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRAX
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRAY
        READ( Un, IOSTAT=ErrStat) LocalVar%PtfmRAZ
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(4)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(5)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(6)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(7)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(8)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(9)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(10)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(11)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_DesiredL(12)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(4)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(5)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(6)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(7)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(8)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(9)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(10)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(11)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedL(12)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(4)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(5)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(6)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(7)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(8)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(9)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(10)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(11)
        READ( Un, IOSTAT=ErrStat) LocalVar%CC_ActuatedDL(12)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(4)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(5)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(6)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(7)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(8)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(9)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(10)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(11)
        READ( Un, IOSTAT=ErrStat) LocalVar%StC_Input(12)
        READ( Un, IOSTAT=ErrStat) LocalVar%Flp_Angle(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%Flp_Angle(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%Flp_Angle(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%RootMyb_Last(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%RootMyb_Last(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%RootMyb_Last(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%ACC_INFILE_SIZE
        ALLOCATE(LocalVar%ACC_INFILE(LocalVar%ACC_INFILE_SIZE))
        READ( Un, IOSTAT=ErrStat) LocalVar%ACC_INFILE
        READ( Un, IOSTAT=ErrStat) LocalVar%restart
        READ( Un, IOSTAT=ErrStat) LocalVar%AWC_complexangle(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%AWC_complexangle(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%AWC_complexangle(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%TiltMean
        READ( Un, IOSTAT=ErrStat) LocalVar%YawMean
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_ID
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_YawOffset
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_TorqueOffset
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_PitOffset(1)
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_PitOffset(2)
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_PitOffset(3)
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_R_Speed
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_R_Torque
        READ( Un, IOSTAT=ErrStat) LocalVar%ZMQ_R_Pitch
        READ( Un, IOSTAT=ErrStat) LocalVar%WE%om_r
        READ( Un, IOSTAT=ErrStat) LocalVar%WE%v_t
        READ( Un, IOSTAT=ErrStat) LocalVar%WE%v_m
        READ( Un, IOSTAT=ErrStat) LocalVar%WE%v_h
        READ( Un, IOSTAT=ErrStat) LocalVar%WE%P
        READ( Un, IOSTAT=ErrStat) LocalVar%WE%xh
        READ( Un, IOSTAT=ErrStat) LocalVar%WE%K
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_a1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_a0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_b1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_b0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_InputSignalLast
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf1_OutputSignalLast
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_a2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_a1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_a0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_b2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_b1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_b0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_InputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_OutputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_InputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpf2_OutputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_a2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_a1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_a0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_b2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_b1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_b0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_InputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_OutputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_InputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%lpfV_OutputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%hpf_InputSignalLast
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%hpf_OutputSignalLast
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_OutputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_OutputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_InputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_InputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_b2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_b0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_a2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_a1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nfs_a0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_OutputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_OutputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_InputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_InputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_b2
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_b1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_b0
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_a1
        READ( Un, IOSTAT=ErrStat) LocalVar%FP%nf_a0
        READ( Un, IOSTAT=ErrStat) LocalVar%piP%ITerm
        READ( Un, IOSTAT=ErrStat) LocalVar%piP%ITermLast
        READ( Un, IOSTAT=ErrStat) LocalVar%piP%ITerm2
        READ( Un, IOSTAT=ErrStat) LocalVar%piP%ITermLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%piP%ELast
        READ( Un, IOSTAT=ErrStat) LocalVar%resP%res_OutputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%resP%res_OutputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%resP%res_InputSignalLast1
        READ( Un, IOSTAT=ErrStat) LocalVar%resP%res_InputSignalLast2
        READ( Un, IOSTAT=ErrStat) LocalVar%rlP%LastSignal
        READ( Un, IOSTAT=ErrStat) objInst%instLPF
        READ( Un, IOSTAT=ErrStat) objInst%instSecLPF
        READ( Un, IOSTAT=ErrStat) objInst%instSecLPFV
        READ( Un, IOSTAT=ErrStat) objInst%instHPF
        READ( Un, IOSTAT=ErrStat) objInst%instNotchSlopes
        READ( Un, IOSTAT=ErrStat) objInst%instNotch
        READ( Un, IOSTAT=ErrStat) objInst%instPI
        READ( Un, IOSTAT=ErrStat) objInst%instRes
        READ( Un, IOSTAT=ErrStat) objInst%instRL
        Close ( Un )
        IF ( ErrStat /= 0 ) THEN
            ErrVar%aviFAIL = 1
            ErrVar%ErrMsg  = 'ROSCO_IO: Error reading checkpoint file.'
        ENDIF
    ENDIF
    ! Read Parameter files
    CALL ReadControlParameterFileSub(CntrPar, LocalVar, LocalVar%ACC_INFILE, LocalVar%ACC_INFILE_SIZE, RootName, ErrVar)
    IF (CntrPar%WE_Mode > 0) THEN
        CALL READCpFile(CntrPar, PerfData, ErrVar)
    ENDIF
END SUBROUTINE ReadRestartFile

 
SUBROUTINE Debug(LocalVar, CntrPar, DebugVar, ErrVar, avrSWAP, RootName, size_avcOUTNAME)
! Debug routine, defines what gets printed to DEBUG.dbg if LoggingLevel = 1

    TYPE(ControlParameters), INTENT(IN) :: CntrPar
    TYPE(LocalVariables), INTENT(IN) :: LocalVar
    TYPE(DebugVariables), INTENT(IN) :: DebugVar
    TYPE(ErrorVariables),       INTENT(INOUT)   :: ErrVar

    INTEGER(IntKi), INTENT(IN)      :: size_avcOUTNAME
    INTEGER(IntKi)                  :: I , nDebugOuts, nLocalVars   ! Generic index.
    CHARACTER(1), PARAMETER         :: Tab = CHAR(9)                ! The tab character.
    CHARACTER(100)                  :: FmtDat                       ! The format of the debugging data
    INTEGER(IntKi), SAVE            :: UnDb                         ! I/O unit for the debugging information
    INTEGER(IntKi), SAVE            :: UnDb2                        ! I/O unit for the debugging information, avrSWAP
    INTEGER(IntKi), SAVE            :: UnDb3                        ! I/O unit for the debugging information, avrSWAP
    REAL(ReKi), INTENT(INOUT)       :: avrSWAP(*)                   ! The swap array, used to pass data to, and receive data from, the DLL controller.
    CHARACTER(size_avcOUTNAME), INTENT(IN) :: RootName            ! a Fortran version of the input C string (not considered an array here)    [subtract 1 for the C null-character]
    CHARACTER(200)                  :: Version                      ! git version of ROSCO
    CHARACTER(15), ALLOCATABLE      :: DebugOutStrings(:), DebugOutUnits(:)

    ! Avr output writing
    INTEGER(IntKi), SAVE, DIMENSION(:), ALLOCATABLE     :: avrIndices
    INTEGER(IntKi)                  :: avrBaseLength = 85
    INTEGER(IntKi)                  :: Ind
    CHARACTER(100)                  :: avrFmt

    REAL(DbKi), ALLOCATABLE         :: DebugOutData(:)
 
    CHARACTER(15), DIMENSION(154)      :: LocalVarOutStrings
    REAL(DbKi), ALLOCATABLE         :: LocalVarOutData(:)
 
    nDebugOuts = 26
    Allocate(DebugOutData(nDebugOuts))
    Allocate(DebugOutStrings(nDebugOuts))
    Allocate(DebugOutUnits(nDebugOuts))
    DebugOutData(1) = DebugVar%WE_Cp
    DebugOutData(2) = DebugVar%WE_b
    DebugOutData(3) = DebugVar%WE_w
    DebugOutData(4) = DebugVar%WE_t
    DebugOutData(5) = DebugVar%WE_Vm
    DebugOutData(6) = DebugVar%WE_Vt
    DebugOutData(7) = DebugVar%WE_Vw
    DebugOutData(8) = DebugVar%WE_lambda
    DebugOutData(9) = DebugVar%PC_PICommand
    DebugOutData(10) = DebugVar%GenSpeedF
    DebugOutData(11) = DebugVar%RotSpeedF
    DebugOutData(12) = DebugVar%NacIMU_FA_AccF
    DebugOutData(13) = DebugVar%FA_AccF
    DebugOutData(14) = DebugVar%Fl_PitCom
    DebugOutData(15) = DebugVar%PC_MinPit
    DebugOutData(16) = DebugVar%axisTilt_1P
    DebugOutData(17) = DebugVar%axisYaw_1P
    DebugOutData(18) = DebugVar%axisTilt_2P
    DebugOutData(19) = DebugVar%axisYaw_2P
    DebugOutData(20) = DebugVar%YawRateCom
    DebugOutData(21) = DebugVar%NacHeadingTarget
    DebugOutData(22) = DebugVar%NacVaneOffset
    DebugOutData(23) = DebugVar%Yaw_Err
    DebugOutData(24) = DebugVar%YawState
    DebugOutData(25) = DebugVar%VS_RefSpd
    DebugOutData(26) = DebugVar%PC_RefSpd
    DebugOutStrings = [CHARACTER(15) ::  'WE_Cp', 'WE_b', 'WE_w', 'WE_t', 'WE_Vm', & 
                                      'WE_Vt', 'WE_Vw', 'WE_lambda', 'PC_PICommand', 'GenSpeedF', & 
                                      'RotSpeedF', 'NacIMU_FA_AccF', 'FA_AccF', 'Fl_PitCom', 'PC_MinPit', & 
                                      'axisTilt_1P', 'axisYaw_1P', 'axisTilt_2P', 'axisYaw_2P', 'YawRateCom', & 
                                      'NacHeadingTarget', 'NacVaneOffset', 'Yaw_Err', 'YawState', 'VS_RefSpd', & 
                                      'PC_RefSpd']
    DebugOutUnits = [CHARACTER(15) ::  '[-]', '[-]', '[-]', '[-]', '[m/s]', & 
                                      '[m/s]', '[m/s]', '[rad]', '[rad]', '[rad/s]', & 
                                      '[rad/s]', '[rad/s]', '[m/s]', '[rad]', '[rad]', & 
                                      '[N/A]', '[N/A]', '[N/A]', '[N/A]', '[rad/s]', & 
                                      '[deg]', '[deg]', '[deg]', '[N/A]', '[rad/s]', & 
                                      '[rad/s]']
    nLocalVars = 154
    Allocate(LocalVarOutData(nLocalVars))
    LocalVarOutData(1) = LocalVar%iStatus
    LocalVarOutData(2) = LocalVar%AlreadyInitialized
    LocalVarOutData(3) = LocalVar%RestartWSE
    LocalVarOutData(4) = LocalVar%Time
    LocalVarOutData(5) = LocalVar%DT
    LocalVarOutData(6) = LocalVar%n_DT
    LocalVarOutData(7) = LocalVar%Time_Last
    LocalVarOutData(8) = LocalVar%VS_GenPwr
    LocalVarOutData(9) = LocalVar%GenSpeed
    LocalVarOutData(10) = LocalVar%RotSpeed
    LocalVarOutData(11) = LocalVar%NacHeading
    LocalVarOutData(12) = LocalVar%NacVane
    LocalVarOutData(13) = LocalVar%NacVaneF
    LocalVarOutData(14) = LocalVar%HorWindV
    LocalVarOutData(15) = LocalVar%HorWindV_F
    LocalVarOutData(16) = LocalVar%rootMOOP(1)
    LocalVarOutData(17) = LocalVar%rootMOOPF(1)
    LocalVarOutData(18) = LocalVar%BlPitch(1)
    LocalVarOutData(19) = LocalVar%BlPitchCMeas
    LocalVarOutData(20) = LocalVar%Azimuth
    LocalVarOutData(21) = LocalVar%OL_Azimuth
    LocalVarOutData(22) = LocalVar%AzUnwrapped
    LocalVarOutData(23) = LocalVar%AzError
    LocalVarOutData(24) = LocalVar%GenTqAz
    LocalVarOutData(25) = LocalVar%AzBuffer(1)
    LocalVarOutData(26) = LocalVar%NumBl
    LocalVarOutData(27) = LocalVar%FA_Acc
    LocalVarOutData(28) = LocalVar%NacIMU_FA_Acc
    LocalVarOutData(29) = LocalVar%FA_AccHPF
    LocalVarOutData(30) = LocalVar%FA_AccHPFI
    LocalVarOutData(31) = LocalVar%FA_PitCom(1)
    LocalVarOutData(32) = LocalVar%VS_RefSpd
    LocalVarOutData(33) = LocalVar%VS_RefSpd_TSR
    LocalVarOutData(34) = LocalVar%VS_RefSpd_TRA
    LocalVarOutData(35) = LocalVar%VS_RefSpd_RL
    LocalVarOutData(36) = LocalVar%PC_RefSpd
    LocalVarOutData(37) = LocalVar%PC_RefSpd_SS
    LocalVarOutData(38) = LocalVar%PC_RefSpd_PRC
    LocalVarOutData(39) = LocalVar%RotSpeedF
    LocalVarOutData(40) = LocalVar%GenSpeedF
    LocalVarOutData(41) = LocalVar%GenTq
    LocalVarOutData(42) = LocalVar%GenTqMeas
    LocalVarOutData(43) = LocalVar%GenArTq
    LocalVarOutData(44) = LocalVar%GenBrTq
    LocalVarOutData(45) = LocalVar%VS_KOmega2_GenTq
    LocalVarOutData(46) = LocalVar%VS_ConstPwr_GenTq
    LocalVarOutData(47) = LocalVar%IPC_PitComF(1)
    LocalVarOutData(48) = LocalVar%PC_KP
    LocalVarOutData(49) = LocalVar%PC_KI
    LocalVarOutData(50) = LocalVar%PC_KD
    LocalVarOutData(51) = LocalVar%PC_TF
    LocalVarOutData(52) = LocalVar%PC_MaxPit
    LocalVarOutData(53) = LocalVar%PC_MinPit
    LocalVarOutData(54) = LocalVar%PC_PitComT
    LocalVarOutData(55) = LocalVar%PC_PitComT_Last
    LocalVarOutData(56) = LocalVar%PC_PitComTF
    LocalVarOutData(57) = LocalVar%PC_PitComT_IPC(1)
    LocalVarOutData(58) = LocalVar%PC_PwrErr
    LocalVarOutData(59) = LocalVar%PC_SpdErr
    LocalVarOutData(60) = LocalVar%IPC_AxisTilt_1P
    LocalVarOutData(61) = LocalVar%IPC_AxisYaw_1P
    LocalVarOutData(62) = LocalVar%IPC_AxisTilt_2P
    LocalVarOutData(63) = LocalVar%IPC_AxisYaw_2P
    LocalVarOutData(64) = LocalVar%axisTilt_1P
    LocalVarOutData(65) = LocalVar%axisYaw_1P
    LocalVarOutData(66) = LocalVar%axisYawF_1P
    LocalVarOutData(67) = LocalVar%axisTilt_2P
    LocalVarOutData(68) = LocalVar%axisYaw_2P
    LocalVarOutData(69) = LocalVar%axisYawF_2P
    LocalVarOutData(70) = LocalVar%IPC_KI(1)
    LocalVarOutData(71) = LocalVar%IPC_KP(1)
    LocalVarOutData(72) = LocalVar%IPC_IntSat
    LocalVarOutData(73) = LocalVar%PC_State
    LocalVarOutData(74) = LocalVar%PitCom(1)
    LocalVarOutData(75) = LocalVar%PitCom_SD(1)
    LocalVarOutData(76) = LocalVar%PitComAct(1)
    LocalVarOutData(77) = LocalVar%SS_DelOmegaF
    LocalVarOutData(78) = LocalVar%TestType
    LocalVarOutData(79) = LocalVar%Kp_Float
    LocalVarOutData(80) = LocalVar%VS_MaxTq
    LocalVarOutData(81) = LocalVar%VS_LastGenTrq
    LocalVarOutData(82) = LocalVar%VS_LastGenPwr
    LocalVarOutData(83) = LocalVar%VS_MechGenPwr
    LocalVarOutData(84) = LocalVar%VS_SpdErrAr
    LocalVarOutData(85) = LocalVar%VS_SpdErrBr
    LocalVarOutData(86) = LocalVar%VS_SpdErr
    LocalVarOutData(87) = LocalVar%VS_State
    LocalVarOutData(88) = LocalVar%VS_Rgn3Pitch
    LocalVarOutData(89) = LocalVar%WE_Vw
    LocalVarOutData(90) = LocalVar%WE_Vw_F
    LocalVarOutData(91) = LocalVar%WE_VwI
    LocalVarOutData(92) = LocalVar%WE_VwIdot
    LocalVarOutData(93) = LocalVar%WE_Op
    LocalVarOutData(94) = LocalVar%WE_Op_Last
    LocalVarOutData(95) = LocalVar%VS_LastGenTrqF
    LocalVarOutData(96) = LocalVar%PRC_WSE_F
    LocalVarOutData(97) = LocalVar%PRC_R_Speed
    LocalVarOutData(98) = LocalVar%PRC_R_Torque
    LocalVarOutData(99) = LocalVar%PRC_R_Pitch
    LocalVarOutData(100) = LocalVar%PRC_R_Total
    LocalVarOutData(101) = LocalVar%PRC_Min_Pitch
    LocalVarOutData(102) = LocalVar%PS_Min_Pitch
    LocalVarOutData(103) = LocalVar%OL_Index
    LocalVarOutData(104) = LocalVar%SU_Stage
    LocalVarOutData(105) = LocalVar%SU_LoadStageStartTime
    LocalVarOutData(106) = LocalVar%SU_RotSpeedF
    LocalVarOutData(107) = LocalVar%SD_Trigger
    LocalVarOutData(108) = LocalVar%SD_BlPitchF
    LocalVarOutData(109) = LocalVar%SD_NacVaneF
    LocalVarOutData(110) = LocalVar%SD_GenSpeedF
    LocalVarOutData(111) = LocalVar%SD_Stage
    LocalVarOutData(112) = LocalVar%SD_StageStartTime
    LocalVarOutData(113) = LocalVar%GenTq_SD
    LocalVarOutData(114) = LocalVar%Fl_PitCom
    LocalVarOutData(115) = LocalVar%NACIMU_FA_AccF
    LocalVarOutData(116) = LocalVar%FA_AccF
    LocalVarOutData(117) = LocalVar%FA_Hist
    LocalVarOutData(118) = LocalVar%TRA_LastRefSpd
    LocalVarOutData(119) = LocalVar%VS_RefSpeed
    LocalVarOutData(120) = LocalVar%PtfmTDX
    LocalVarOutData(121) = LocalVar%PtfmTDY
    LocalVarOutData(122) = LocalVar%PtfmTDZ
    LocalVarOutData(123) = LocalVar%PtfmRDX
    LocalVarOutData(124) = LocalVar%PtfmRDY
    LocalVarOutData(125) = LocalVar%PtfmRDZ
    LocalVarOutData(126) = LocalVar%PtfmTVX
    LocalVarOutData(127) = LocalVar%PtfmTVY
    LocalVarOutData(128) = LocalVar%PtfmTVZ
    LocalVarOutData(129) = LocalVar%PtfmRVX
    LocalVarOutData(130) = LocalVar%PtfmRVY
    LocalVarOutData(131) = LocalVar%PtfmRVZ
    LocalVarOutData(132) = LocalVar%PtfmTAX
    LocalVarOutData(133) = LocalVar%PtfmTAY
    LocalVarOutData(134) = LocalVar%PtfmTAZ
    LocalVarOutData(135) = LocalVar%PtfmRAX
    LocalVarOutData(136) = LocalVar%PtfmRAY
    LocalVarOutData(137) = LocalVar%PtfmRAZ
    LocalVarOutData(138) = LocalVar%CC_DesiredL(1)
    LocalVarOutData(139) = LocalVar%CC_ActuatedL(1)
    LocalVarOutData(140) = LocalVar%CC_ActuatedDL(1)
    LocalVarOutData(141) = LocalVar%StC_Input(1)
    LocalVarOutData(142) = LocalVar%Flp_Angle(1)
    LocalVarOutData(143) = LocalVar%RootMyb_Last(1)
    LocalVarOutData(144) = LocalVar%ACC_INFILE_SIZE
    LocalVarOutData(145) = LocalVar%AWC_complexangle(1)
    LocalVarOutData(146) = LocalVar%TiltMean
    LocalVarOutData(147) = LocalVar%YawMean
    LocalVarOutData(148) = LocalVar%ZMQ_ID
    LocalVarOutData(149) = LocalVar%ZMQ_YawOffset
    LocalVarOutData(150) = LocalVar%ZMQ_TorqueOffset
    LocalVarOutData(151) = LocalVar%ZMQ_PitOffset(1)
    LocalVarOutData(152) = LocalVar%ZMQ_R_Speed
    LocalVarOutData(153) = LocalVar%ZMQ_R_Torque
    LocalVarOutData(154) = LocalVar%ZMQ_R_Pitch

    LocalVarOutStrings(1) = 'iStatus'
    LocalVarOutStrings(2) = 'AlreadyInitialized'
    LocalVarOutStrings(3) = 'RestartWSE'
    LocalVarOutStrings(4) = 'Time'
    LocalVarOutStrings(5) = 'DT'
    LocalVarOutStrings(6) = 'n_DT'
    LocalVarOutStrings(7) = 'Time_Last'
    LocalVarOutStrings(8) = 'VS_GenPwr'
    LocalVarOutStrings(9) = 'GenSpeed'
    LocalVarOutStrings(10) = 'RotSpeed'
    LocalVarOutStrings(11) = 'NacHeading'
    LocalVarOutStrings(12) = 'NacVane'
    LocalVarOutStrings(13) = 'NacVaneF'
    LocalVarOutStrings(14) = 'HorWindV'
    LocalVarOutStrings(15) = 'HorWindV_F'
    LocalVarOutStrings(16) = 'rootMOOP'
    LocalVarOutStrings(17) = 'rootMOOPF'
    LocalVarOutStrings(18) = 'BlPitch'
    LocalVarOutStrings(19) = 'BlPitchCMeas'
    LocalVarOutStrings(20) = 'Azimuth'
    LocalVarOutStrings(21) = 'OL_Azimuth'
    LocalVarOutStrings(22) = 'AzUnwrapped'
    LocalVarOutStrings(23) = 'AzError'
    LocalVarOutStrings(24) = 'GenTqAz'
    LocalVarOutStrings(25) = 'AzBuffer'
    LocalVarOutStrings(26) = 'NumBl'
    LocalVarOutStrings(27) = 'FA_Acc'
    LocalVarOutStrings(28) = 'NacIMU_FA_Acc'
    LocalVarOutStrings(29) = 'FA_AccHPF'
    LocalVarOutStrings(30) = 'FA_AccHPFI'
    LocalVarOutStrings(31) = 'FA_PitCom'
    LocalVarOutStrings(32) = 'VS_RefSpd'
    LocalVarOutStrings(33) = 'VS_RefSpd_TSR'
    LocalVarOutStrings(34) = 'VS_RefSpd_TRA'
    LocalVarOutStrings(35) = 'VS_RefSpd_RL'
    LocalVarOutStrings(36) = 'PC_RefSpd'
    LocalVarOutStrings(37) = 'PC_RefSpd_SS'
    LocalVarOutStrings(38) = 'PC_RefSpd_PRC'
    LocalVarOutStrings(39) = 'RotSpeedF'
    LocalVarOutStrings(40) = 'GenSpeedF'
    LocalVarOutStrings(41) = 'GenTq'
    LocalVarOutStrings(42) = 'GenTqMeas'
    LocalVarOutStrings(43) = 'GenArTq'
    LocalVarOutStrings(44) = 'GenBrTq'
    LocalVarOutStrings(45) = 'VS_KOmega2_GenTq'
    LocalVarOutStrings(46) = 'VS_ConstPwr_GenTq'
    LocalVarOutStrings(47) = 'IPC_PitComF'
    LocalVarOutStrings(48) = 'PC_KP'
    LocalVarOutStrings(49) = 'PC_KI'
    LocalVarOutStrings(50) = 'PC_KD'
    LocalVarOutStrings(51) = 'PC_TF'
    LocalVarOutStrings(52) = 'PC_MaxPit'
    LocalVarOutStrings(53) = 'PC_MinPit'
    LocalVarOutStrings(54) = 'PC_PitComT'
    LocalVarOutStrings(55) = 'PC_PitComT_Last'
    LocalVarOutStrings(56) = 'PC_PitComTF'
    LocalVarOutStrings(57) = 'PC_PitComT_IPC'
    LocalVarOutStrings(58) = 'PC_PwrErr'
    LocalVarOutStrings(59) = 'PC_SpdErr'
    LocalVarOutStrings(60) = 'IPC_AxisTilt_1P'
    LocalVarOutStrings(61) = 'IPC_AxisYaw_1P'
    LocalVarOutStrings(62) = 'IPC_AxisTilt_2P'
    LocalVarOutStrings(63) = 'IPC_AxisYaw_2P'
    LocalVarOutStrings(64) = 'axisTilt_1P'
    LocalVarOutStrings(65) = 'axisYaw_1P'
    LocalVarOutStrings(66) = 'axisYawF_1P'
    LocalVarOutStrings(67) = 'axisTilt_2P'
    LocalVarOutStrings(68) = 'axisYaw_2P'
    LocalVarOutStrings(69) = 'axisYawF_2P'
    LocalVarOutStrings(70) = 'IPC_KI'
    LocalVarOutStrings(71) = 'IPC_KP'
    LocalVarOutStrings(72) = 'IPC_IntSat'
    LocalVarOutStrings(73) = 'PC_State'
    LocalVarOutStrings(74) = 'PitCom'
    LocalVarOutStrings(75) = 'PitCom_SD'
    LocalVarOutStrings(76) = 'PitComAct'
    LocalVarOutStrings(77) = 'SS_DelOmegaF'
    LocalVarOutStrings(78) = 'TestType'
    LocalVarOutStrings(79) = 'Kp_Float'
    LocalVarOutStrings(80) = 'VS_MaxTq'
    LocalVarOutStrings(81) = 'VS_LastGenTrq'
    LocalVarOutStrings(82) = 'VS_LastGenPwr'
    LocalVarOutStrings(83) = 'VS_MechGenPwr'
    LocalVarOutStrings(84) = 'VS_SpdErrAr'
    LocalVarOutStrings(85) = 'VS_SpdErrBr'
    LocalVarOutStrings(86) = 'VS_SpdErr'
    LocalVarOutStrings(87) = 'VS_State'
    LocalVarOutStrings(88) = 'VS_Rgn3Pitch'
    LocalVarOutStrings(89) = 'WE_Vw'
    LocalVarOutStrings(90) = 'WE_Vw_F'
    LocalVarOutStrings(91) = 'WE_VwI'
    LocalVarOutStrings(92) = 'WE_VwIdot'
    LocalVarOutStrings(93) = 'WE_Op'
    LocalVarOutStrings(94) = 'WE_Op_Last'
    LocalVarOutStrings(95) = 'VS_LastGenTrqF'
    LocalVarOutStrings(96) = 'PRC_WSE_F'
    LocalVarOutStrings(97) = 'PRC_R_Speed'
    LocalVarOutStrings(98) = 'PRC_R_Torque'
    LocalVarOutStrings(99) = 'PRC_R_Pitch'
    LocalVarOutStrings(100) = 'PRC_R_Total'
    LocalVarOutStrings(101) = 'PRC_Min_Pitch'
    LocalVarOutStrings(102) = 'PS_Min_Pitch'
    LocalVarOutStrings(103) = 'OL_Index'
    LocalVarOutStrings(104) = 'SU_Stage'
    LocalVarOutStrings(105) = 'SU_LoadStageStartTime'
    LocalVarOutStrings(106) = 'SU_RotSpeedF'
    LocalVarOutStrings(107) = 'SD_Trigger'
    LocalVarOutStrings(108) = 'SD_BlPitchF'
    LocalVarOutStrings(109) = 'SD_NacVaneF'
    LocalVarOutStrings(110) = 'SD_GenSpeedF'
    LocalVarOutStrings(111) = 'SD_Stage'
    LocalVarOutStrings(112) = 'SD_StageStartTime'
    LocalVarOutStrings(113) = 'GenTq_SD'
    LocalVarOutStrings(114) = 'Fl_PitCom'
    LocalVarOutStrings(115) = 'NACIMU_FA_AccF'
    LocalVarOutStrings(116) = 'FA_AccF'
    LocalVarOutStrings(117) = 'FA_Hist'
    LocalVarOutStrings(118) = 'TRA_LastRefSpd'
    LocalVarOutStrings(119) = 'VS_RefSpeed'
    LocalVarOutStrings(120) = 'PtfmTDX'
    LocalVarOutStrings(121) = 'PtfmTDY'
    LocalVarOutStrings(122) = 'PtfmTDZ'
    LocalVarOutStrings(123) = 'PtfmRDX'
    LocalVarOutStrings(124) = 'PtfmRDY'
    LocalVarOutStrings(125) = 'PtfmRDZ'
    LocalVarOutStrings(126) = 'PtfmTVX'
    LocalVarOutStrings(127) = 'PtfmTVY'
    LocalVarOutStrings(128) = 'PtfmTVZ'
    LocalVarOutStrings(129) = 'PtfmRVX'
    LocalVarOutStrings(130) = 'PtfmRVY'
    LocalVarOutStrings(131) = 'PtfmRVZ'
    LocalVarOutStrings(132) = 'PtfmTAX'
    LocalVarOutStrings(133) = 'PtfmTAY'
    LocalVarOutStrings(134) = 'PtfmTAZ'
    LocalVarOutStrings(135) = 'PtfmRAX'
    LocalVarOutStrings(136) = 'PtfmRAY'
    LocalVarOutStrings(137) = 'PtfmRAZ'
    LocalVarOutStrings(138) = 'CC_DesiredL'
    LocalVarOutStrings(139) = 'CC_ActuatedL'
    LocalVarOutStrings(140) = 'CC_ActuatedDL'
    LocalVarOutStrings(141) = 'StC_Input'
    LocalVarOutStrings(142) = 'Flp_Angle'
    LocalVarOutStrings(143) = 'RootMyb_Last'
    LocalVarOutStrings(144) = 'ACC_INFILE_SIZE'
    LocalVarOutStrings(145) = 'AWC_complexangle'
    LocalVarOutStrings(146) = 'TiltMean'
    LocalVarOutStrings(147) = 'YawMean'
    LocalVarOutStrings(148) = 'ZMQ_ID'
    LocalVarOutStrings(149) = 'ZMQ_YawOffset'
    LocalVarOutStrings(150) = 'ZMQ_TorqueOffset'
    LocalVarOutStrings(151) = 'ZMQ_PitOffset'
    LocalVarOutStrings(152) = 'ZMQ_R_Speed'
    LocalVarOutStrings(153) = 'ZMQ_R_Torque'
    LocalVarOutStrings(154) = 'ZMQ_R_Pitch'
    ! Initialize debug file
    IF ((LocalVar%iStatus == 0) .OR. (LocalVar%iStatus == -9))  THEN ! .TRUE. if we're on the first call to the DLL
        IF (CntrPar%LoggingLevel > 0) THEN
            CALL GetNewUnit(UnDb, ErrVar)
            OPEN(unit=UnDb, FILE=TRIM(RootName)//'.RO.dbg')
            WRITE(UnDb, *)  'Generated on '//CurDate()//' at '//CurTime()//' using ROSCO-'//TRIM(rosco_version)
            WRITE(UnDb, '(99(a20,TR5:))') 'Time',   DebugOutStrings
            WRITE(UnDb, '(99(a20,TR5:))') '(sec)',  DebugOutUnits
        END IF

        IF (CntrPar%LoggingLevel > 1) THEN
            CALL GetNewUnit(UnDb2, ErrVar)
            OPEN(unit=UnDb2, FILE=TRIM(RootName)//'.RO.dbg2')
            WRITE(UnDb2, *)  'Generated on '//CurDate()//' at '//CurTime()//' using ROSCO-'//TRIM(rosco_version)
            WRITE(UnDb2, '(155(a20,TR5:))') 'Time',   LocalVarOutStrings
            WRITE(UnDb2, '(155(a20,TR5:))')
        END IF

        IF (CntrPar%LoggingLevel > 2) THEN
            ! Set avrIndices, start with basic indices
            Allocate(avrIndices(avrBaseLength))
            DO Ind = 1, avrBaseLength
                avrIndices(Ind) = Ind
            END DO

            ! Cable control indices
            IF (CntrPar%CC_Mode > 0) THEN
                DO Ind = 1, SIZE(CntrPar%CC_GroupIndex)
                    Call AddToList(avrIndices,CntrPar%CC_GroupIndex(Ind))
                    Call AddToList(avrIndices,CntrPar%CC_GroupIndex(Ind)+1)
                END DO
            END IF

            ! Structural control indices
            IF (CntrPar%StC_Mode > 0) THEN
                DO Ind = 1, SIZE(CntrPar%StC_GroupIndex)
                    Call AddToList(avrIndices,CntrPar%StC_GroupIndex(Ind))
                END DO
            END IF

            ! Format string
            avrFmt = '(A21,'//TRIM(Int2LStr(SIZE(avrIndices)))//'(TR12,"'//'AvrSWAP(",I4,")"))'

            CALL GetNewUnit(UnDb3, ErrVar)
            OPEN(unit=UnDb3, FILE=TRIM(RootName)//'.RO.dbg3')
            WRITE(UnDb3,'(/////)')
            WRITE(UnDb3,avrFmt)  'LocalVar%Time ', (avrIndices)
            WRITE(UnDb3,'(A21,'//TRIM(Int2LStr(SIZE(avrIndices)))//'(TR22,"(-)"))')  '(s)'
        END IF
    END IF

        ! Print simulation status, every 10 seconds
    IF (MODULO(LocalVar%Time, 10.0_DbKi) == 0) THEN
        WRITE(*, 100) LocalVar%GenSpeedF*RPS2RPM, LocalVar%BlPitch(1)*R2D, avrSWAP(15)/1000.0, LocalVar%WE_Vw
        100 FORMAT('Generator speed: ', f6.1, ' RPM, Pitch angle: ', f5.1, ' deg, Power: ', f7.1, ' kW, Est. wind Speed: ', f5.1, ' m/s')
    END IF

    ! Process DebugOutData, LocalVarOutData
    ! Remove very small numbers that cause ******** outputs
    DO I = 1,SIZE(DebugOutData)
        IF (ABS(DebugOutData(I)) < 1E-99) THEN
            DebugOutData(I) = 0
        END IF
        IF (ABS(DebugOutData(I)) > 1E+99) THEN
            DebugOutData(I) = 1E+99
        END IF
    END DO
    
    DO I = 1,SIZE(LocalVarOutData)
        IF (ABS(LocalVarOutData(I)) < 1E-99) THEN
            LocalVarOutData(I) = 0
        END IF
        IF (ABS(LocalVarOutData(I)) > 1E+99) THEN
            LocalVarOutData(I) = 1E+99
        END IF
    END DO
    
    ! Write debug files
    FmtDat = "(F20.5,TR5,154(ES20.5E2,TR5:))"   ! The format of the debugging data
    IF ( MOD(LocalVar%n_DT, CntrPar%n_DT_Out) == 0) THEN
        IF((CntrPar%LoggingLevel > 0) .AND. (LocalVar%iStatus .ge. 0)) THEN
            WRITE (UnDb, TRIM(FmtDat))  LocalVar%Time, DebugOutData
        END IF

        IF((CntrPar%LoggingLevel > 1) .AND. (LocalVar%iStatus .ge. 0)) THEN
            WRITE (UnDb2, TRIM(FmtDat))  LocalVar%Time, LocalVarOutData
        END IF

        IF((CntrPar%LoggingLevel > 2) .AND. (LocalVar%iStatus .ge. 0)) THEN
            WRITE (UnDb3, TRIM(FmtDat))    LocalVar%Time, avrSWAP(avrIndices)
        END IF
    END IF

    ! Close all files when simulation finished
    IF (LocalVar%iStatus < 0) THEN
        CLOSE(UnDb)
        CLOSE(UnDb2)
        CLOSE(UnDb3)
    ENDIF
END SUBROUTINE Debug

END MODULE ROSCO_IO
